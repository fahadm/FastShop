@using Microsoft.Web.Helpers;

@{
    

    if (WebSecurity.IsAuthenticated && Roles.IsUserInRole("Admin"))
    {
        //Everything is ok

        if (IsPost)
        {
            string filename = Request.Files[0].FileName.Split('.')[0];

            WebImage wi = new WebImage(Request.Files[0].InputStream);

            wi.Save(@"~\Images\large\" + filename, "png");
            wi.Resize(157, 157, false);

            wi.Save(@"~\Images\small\" + filename , "png");
            var db = Database.Open("shopping");

            db.Execute("insert into Category(Name,Image) values(@0,@1)", Request.Form["name"].ToString(), filename + ".png");


        }

    }
    else
    {
    <text> Forbidden</text>
        Response.Redirect("~/");
    }
}
<form action="#" method="post" enctype="multipart/form-data">
    <div class="row-fluid ">


        <div class="span4 offset2" style="text-align: center">Category Name </div>
        <div class="span4" style="text-align: left">
            <input type="text" name="name" placeholder="Text input">
        </div>
    </div>
    
        
        <div class="row-fluid ">
            <div class="span4 offset2" style="text-align: center">Category Image</div>
            <div class="span4" style="text-align: left">
                @FileUpload.GetHtml("FileName", 1, false, false)
            </div>

        </div>
        
</form>
<div class="row-fluid " style="text-align: center">
    <button type="submit" class="btn btn-info"><i class="icon-white icon-plus"></i>Add </button>


</div>

